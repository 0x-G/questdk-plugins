import { parseEther, parseUnits, zeroAddress } from 'viem'
import {
  GreaterThanOrEqual,
  type SwapActionParams,
} from '@rabbitholegg/questdk'
import { type TestParams, createTestCase, Chains } from './utils'
import { VAULT_CONTRACT } from './constants'

export const POLYGON_SWAP: TestParams<SwapActionParams> = {
  transaction: {
    chainId: 137,
    from: '0xa99f898530df1514a566f1a6562d62809e99557d',
    hash: '0x4abfead591efbf6cf3760075db69c52fc338acccd255d5382d01314bb7fe8ee3',
    input: '0x52bbbe2900000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000a99f898530df1514a566f1a6562d62809e99557d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a99f898530df1514a566f1a6562d62809e99557d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000021cbdb000000000000000000000000000000000000000000000000000000006564ca21d208168d2a512240eb82582205d94a0710bce4e7000100000000000000000038000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002791bca1f2de4661ed88a30c99a7a9449aa8417400000000000000000000000000000000000000000000000029a2241af62c000000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000000',
    to: '0xba12222222228d8ba445958a75a0704d566bf2c8',
    value: '3000000000000000000',
  },
  params: {
    chainId: Chains.POLYGON_POS,
    contractAddress: VAULT_CONTRACT,
    tokenIn: zeroAddress,
    tokenOut: '0x2791bca1f2de4661ed88a30c99a7a9449aa84174', // USDC.e
    amountIn: GreaterThanOrEqual(parseEther('3')),
    amountOut: GreaterThanOrEqual(parseUnits('2', 6)),
    recipient: '0xa99f898530df1514a566f1a6562d62809e99557d'
  },
}

export const POLYGON_BATCH_SWAP: TestParams<SwapActionParams> = {
  transaction: {
    chainId: 137,
    from: '0xa99f898530df1514a566f1a6562d62809e99557d',
    hash: '0xfb100bfb3c54144814c758f06f4ce9eb1f72c065a81886213f7f4bf76bd424cb',
    input: '0x945bcec9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000300000000000000000000000000a99f898530df1514a566f1a6562d62809e99557d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a99f898530df1514a566f1a6562d62809e99557d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000380000000000000000000000000000000000000000000000000000000006564ccb300000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000010036128d5436d2d70cab39c9af9cce146c38554ff0000100000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000128b59380e339fc00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000297e37f1873d2dab4487aa67cd56b58e2f2787500010000000000000000000200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000d6df932a45c0f255f85145f286ea0b292b21c90b0000000000000000000000007ceb23fd6bc0add59e62ac25578270cff1b9f619000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000128b59380e339fc0000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffff6d3a13700af5503e',
    to: '0xba12222222228d8ba445958a75a0704d566bf2c8',
    value: '0',
  },
  params: {
    chainId: Chains.POLYGON_POS,
    contractAddress: VAULT_CONTRACT,
    tokenIn: '0xd6df932a45c0f255f85145f286ea0b292b21c90b', // AAVE
    tokenOut: zeroAddress, // MATIC
    amountIn: GreaterThanOrEqual(parseUnits('0.0835', 18)),
    amountOut: GreaterThanOrEqual(parseEther('10.57611940')),
    recipient: '0xa99f898530df1514a566f1a6562d62809e99557d'
  },
}

export const passingTestCases = [
  createTestCase(POLYGON_SWAP, 'when making a swap on polygon'),
  createTestCase(POLYGON_BATCH_SWAP, 'when making a batch swap on polygon'),
]